# 阅读《网络是怎样连接的》

<!-- TOC -->

- [1. 浏览器生成消息--探索浏览器内部](#1-浏览器生成消息--探索浏览器内部)
- [2. 用电信号传输 TCP/IP 数据](#2-用电信号传输-tcpip-数据)
    - [2.1. 创建套接字](#21-创建套接字)
    - [2.2. 连接服务器](#22-连接服务器)
    - [2.3. 收发数据](#23-收发数据)

<!-- /TOC -->

## 1. 浏览器生成消息--探索浏览器内部



## 2. 用电信号传输 TCP/IP 数据

### 2.1. 创建套接字

- 浏览器、邮件等一般应用程序收发数据时用 TCP；
- DNS 查询等收发较短的控制数据时用 UDP。

**套接字的实体就是通信控制信息**

套接字的作用：套接字中记录了用于控制通信操作的各种控制信息，协议栈则需要根据这些信息判断下一步的行动。

> 协议栈是根据套接字中记录的控制信息来工作的。

- Socket(大写) 表示 Socket 库
- socket(小写) 表示 Socket 库中名为 socket 的程序组件

> 创建套接字时，首先分配一个套接字所需的内存空间，然后向其中写入初始状态。

### 2.2. 连接服务器

创建套接字之后，应用程序就会调用 `connect`，随后协议栈会将本地的套接字和服务器的套接字进行连接（通信双方交换控制信息）。

控制信息：用来控制数据收发操作所需的一些信息。
1. 客户端和服务器相互联络时交换的控制信息，**头部**是用来记录和交换控制信息的
2. 保存在套接字中，用来控制协议栈操作的信息

> 连接操作的第一步是在 TCP 模块处创建表示连接控制信息的头部
> 通过 TCP 头部中的发送方和接受方端口号可以找到要连接的套接字

在断开前，连接（会话）是一直存在的。

连接建立完成之后，connect 执行完毕，控制流程被交回到应用程序。


### 2.3. 收发数据